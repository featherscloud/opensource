# Pinion

> A fast and typesafe code generator

Pinion is a CLI toolkit that allows to create flexible, customizable and typesafe code generators in TypeScript.
Creating and maintaining CLI tooling and generators can be a very time consuming task. Pinion helps with this by

- Putting generator templates as close to your project as possible
- TypeScript first to give you full flexibility over what your generators can do and how
- Using JavaScript template strings instead of hard to debug templating syntaxes like EJS or Mustache 
- A functional programming approach that keeps your generators robust and easy to follow

## Installation

Pinion is installed as a development dependency and its command line is available via `npx pinion`:

```
npm install @feathershq/pinion --save-dev
```

## Usage

By default, the default Pinion CLI looks for a `.pinion/pinion.ts` file as the entrypoint. In your project folder, create a `.pinion/pinion.ts` file with the following content:

```ts
import { PinionContext, generator, runGenerators, prompt } from '@feathershq/pinion'

// The main types of your generator
export interface Context extends PinionContext {
  // Add the types from prompts and command line arguments here
  name: string
}

export const generate = (ctx: Context) => generator(ctx)
  // Ask prompts here (using Inquirer) that should be available to all other generators
  .then(prompt([{
    type: 'input',
    name: 'name',
    message: 'What is the name of your app?'
  }]))
  // Run all *.tpl.ts generators in this folder
  .then(runGenerators(__dirname))
```

Then create a `.pinion/readme.tpl.ts` like this:

```ts
import { generator, renderTemplate, to } from '@feathershq/pinion'
import { Context } from './pinion'

// A template to render using JavaScript template strings
const template = ({ name }: Context) =>
`# ${name}

This is a readme generated by Pinion

Copyright (c) ${new Date().getFullYear()}
`

export const generate = (ctx: Context) => generator(ctx)
  .then(renderTemplate(template, to('readme.md')))
```

Then run

```
npx pinion
```
